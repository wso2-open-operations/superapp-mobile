#!/usr/bin/env sh
set -e

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”— [pre-commit] Hook started"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Collect staged files
STAGED="$(git diff --cached --name-only --diff-filter=ACM || true)"

if [ -z "$STAGED" ]; then
  echo "ğŸ“­ No files staged for commit."
  echo "âœ… [pre-commit] Completed (no checks needed)."
  exit 0
fi

echo "ğŸ“‚ Staged files:"
echo "$STAGED"
echo ""

# Check for frontend changes
if echo "$STAGED" | grep -qE '^frontend/'; then
  echo "ğŸ›   Changes detected in frontend/"
  echo "ğŸš€ Running lint-staged..."
  cd frontend
  npx lint-staged
else
  echo "âš¡ No frontend changes detected."
  echo "â­  Skipping lint-staged."
fi

echo ""
echo "âœ… [pre-commit] Completed successfully."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
